<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="101.6mm" height="76.2mm" viewBox="0 0 101.6 76.2" style="stroke:black;fill:black" stroke-width="0.5">
<g>
  <g stroke="none" font-family="PT Sans,Helvetica Neue,Helvetica,sans" font-size="3.18" fill="#4C404B">
    <text x="11.19" y="57.28" text-anchor="end" style="dominant-baseline:central">1</text>
    <text x="11.19" y="26.87" text-anchor="end" style="dominant-baseline:central">300</text>
    <text x="11.19" y="16.7" text-anchor="end" style="dominant-baseline:central">400</text>
    <text x="11.19" y="37.04" text-anchor="end" style="dominant-baseline:central">200</text>
    <text x="11.19" y="6.53" text-anchor="end" style="dominant-baseline:central">500</text>
    <text x="11.19" y="47.21" text-anchor="end" style="dominant-baseline:central">100</text>
  </g>
  <g stroke="none" font-family="PT Sans,Helvetica Neue,Helvetica,sans" font-size="3.18" fill="#4C404B">
    <text x="94.21" y="62.64" text-anchor="middle">10</text>
    <text x="74.3" y="62.64" text-anchor="middle">5</text>
    <text x="54.4" y="62.64" text-anchor="middle">0</text>
    <text x="34.49" y="62.64" text-anchor="middle">-5</text>
    <text x="14.58" y="62.64" text-anchor="middle">-10</text>
  </g>
  <g stroke="none" font-family="PT Sans,Helvetica Neue,Helvetica,sans" font-size="3.88" fill="#362A35">
    <text x="54.4" y="69.2" text-anchor="middle">x</text>
  </g>
  <g stroke="#FFFFFF" fill="#FFFFFF">
    <path d="M 12.19 5 L 96.6 5 96.6 58.9 12.19 58.9 z" />
  </g>
  <g stroke-width="0.3" stroke="#F5F5F5">
    <path d="M12.19,57.28 L 96.6 57.28" />
    <path d="M12.19,26.87 L 96.6 26.87" />
    <path d="M12.19,16.7 L 96.6 16.7" />
    <path d="M12.19,37.04 L 96.6 37.04" />
    <path d="M12.19,6.53 L 96.6 6.53" />
    <path d="M12.19,47.21 L 96.6 47.21" />
  </g>
  <g stroke-width="0.3" stroke="#F5F5F5">
    <path d="M94.21,5 L 94.21 58.9" />
    <path d="M74.3,5 L 74.3 58.9" />
    <path d="M54.4,5 L 54.4 58.9" />
    <path d="M34.49,5 L 34.49 58.9" />
    <path d="M14.58,5 L 14.58 58.9" />
  </g>
  <g stroke="none">
    <g fill="#4682B4" shape-rendering="crispEdges">
      <g class="geometry" id="id565">
        <path d="M 75.74 57.38 L 77.03 57.38 77.03 56.46 75.74 56.46 z" />
      </g>
      <g class="geometry" id="id561">
        <path d="M 73.15 57.38 L 74.44 57.38 74.44 55.44 73.15 55.44 z" />
      </g>
      <g class="geometry" id="id557">
        <path d="M 70.56 57.38 L 71.85 57.38 71.85 47.61 70.56 47.61 z" />
      </g>
      <g class="geometry" id="id553">
        <path d="M 67.97 57.38 L 69.27 57.38 69.27 41 67.97 41 z" />
      </g>
      <g class="geometry" id="id549">
        <path d="M 65.38 57.38 L 66.68 57.38 66.68 36.93 65.38 36.93 z" />
      </g>
      <g class="geometry" id="id545">
        <path d="M 62.8 57.38 L 64.09 57.38 64.09 42.83 62.8 42.83 z" />
      </g>
      <g class="geometry" id="id541">
        <path d="M 60.21 57.38 L 61.5 57.38 61.5 48.02 60.21 48.02 z" />
      </g>
      <g class="geometry" id="id537">
        <path d="M 57.62 57.38 L 58.91 57.38 58.91 53.61 57.62 53.61 z" />
      </g>
      <g class="geometry" id="id533">
        <path d="M 55.03 57.38 L 56.33 57.38 56.33 56.56 55.03 56.56 z" />
      </g>
      <g class="geometry" id="id529">
        <path d="M 52.44 57.38 L 53.74 57.38 53.74 56.26 52.44 56.26 z" />
      </g>
      <g class="geometry" id="id525">
        <path d="M 49.86 57.38 L 51.15 57.38 51.15 52.09 49.86 52.09 z" />
      </g>
      <g class="geometry" id="id521">
        <path d="M 47.27 57.38 L 48.56 57.38 48.56 40.29 47.27 40.29 z" />
      </g>
      <g class="geometry" id="id517">
        <path d="M 44.68 57.38 L 45.97 57.38 45.97 18.32 44.68 18.32 z" />
      </g>
      <g class="geometry" id="id513">
        <path d="M 42.09 57.38 L 43.39 57.38 43.39 10.29 42.09 10.29 z" />
      </g>
      <g class="geometry" id="id509">
        <path d="M 39.5 57.38 L 40.8 57.38 40.8 18.83 39.5 18.83 z" />
      </g>
      <g class="geometry" id="id505">
        <path d="M 36.92 57.38 L 38.21 57.38 38.21 35.21 36.92 35.21 z" />
      </g>
      <g class="geometry" id="id501">
        <path d="M 34.33 57.38 L 35.62 57.38 35.62 49.24 34.33 49.24 z" />
      </g>
      <g class="geometry" id="id497">
        <path d="M 31.74 57.38 L 33.03 57.38 33.03 55.55 31.74 55.55 z" />
      </g>
      <g class="geometry" id="id493">
        <path d="M 29.15 57.38 L 30.45 57.38 30.45 56.97 29.15 56.97 z" />
      </g>
      <g class="geometry" id="id489">
        <path d="M 26.56 57.38 L 27.86 57.38 27.86 57.38 26.56 57.38 z" />
      </g>
      <g class="geometry" id="id487">
        <path d="M 25.27 57.38 L 26.56 57.38 26.56 57.28 25.27 57.28 z" />
      </g>
      <g class="geometry" id="id491">
        <path d="M 27.86 57.38 L 29.15 57.38 29.15 57.38 27.86 57.38 z" />
      </g>
      <g class="geometry" id="id495">
        <path d="M 30.45 57.38 L 31.74 57.38 31.74 56.77 30.45 56.77 z" />
      </g>
      <g class="geometry" id="id499">
        <path d="M 33.03 57.38 L 34.33 57.38 34.33 54.22 33.03 54.22 z" />
      </g>
      <g class="geometry" id="id503">
        <path d="M 35.62 57.38 L 36.92 57.38 36.92 42.63 35.62 42.63 z" />
      </g>
      <g class="geometry" id="id507">
        <path d="M 38.21 57.38 L 39.5 57.38 39.5 23.41 38.21 23.41 z" />
      </g>
      <g class="geometry" id="id511">
        <path d="M 40.8 57.38 L 42.09 57.38 42.09 13.44 40.8 13.44 z" />
      </g>
      <g class="geometry" id="id515">
        <path d="M 43.39 57.38 L 44.68 57.38 44.68 18.02 43.39 18.02 z" />
      </g>
      <g class="geometry" id="id519">
        <path d="M 45.97 57.38 L 47.27 57.38 47.27 31.65 45.97 31.65 z" />
      </g>
      <g class="geometry" id="id523">
        <path d="M 48.56 57.38 L 49.86 57.38 49.86 46.09 48.56 46.09 z" />
      </g>
      <g class="geometry" id="id527">
        <path d="M 51.15 57.38 L 52.44 57.38 52.44 54.53 51.15 54.53 z" />
      </g>
      <g class="geometry" id="id531">
        <path d="M 53.74 57.38 L 55.03 57.38 55.03 56.46 53.74 56.46 z" />
      </g>
      <g class="geometry" id="id535">
        <path d="M 56.33 57.38 L 57.62 57.38 57.62 56.06 56.33 56.06 z" />
      </g>
      <g class="geometry" id="id539">
        <path d="M 58.91 57.38 L 60.21 57.38 60.21 52.6 58.91 52.6 z" />
      </g>
      <g class="geometry" id="id543">
        <path d="M 61.5 57.38 L 62.8 57.38 62.8 46.39 61.5 46.39 z" />
      </g>
      <g class="geometry" id="id547">
        <path d="M 64.09 57.38 L 65.38 57.38 65.38 39.58 64.09 39.58 z" />
      </g>
      <g class="geometry" id="id551">
        <path d="M 66.68 57.38 L 67.97 57.38 67.97 38.77 66.68 38.77 z" />
      </g>
      <g class="geometry" id="id555">
        <path d="M 69.27 57.38 L 70.56 57.38 70.56 46.39 69.27 46.39 z" />
      </g>
      <g class="geometry" id="id559">
        <path d="M 71.85 57.38 L 73.15 57.38 73.15 50.36 71.85 50.36 z" />
      </g>
      <g class="geometry" id="id563">
        <path d="M 74.44 57.38 L 75.74 57.38 75.74 56.06 74.44 56.06 z" />
      </g>
      <g class="geometry" id="id567">
        <path d="M 77.03 57.38 L 78.32 57.38 78.32 56.97 77.03 56.97 z" />
      </g>
    </g>
    <g visibility="hidden" font-family="PT Sans,Helvetica Neue,Helvetica,sans" font-size="3.18">
      <g id="id564">
        <text x="76.38" y="55.46" text-anchor="middle">9</text>
      </g>
      <g id="id560">
        <text x="73.79" y="54.44" text-anchor="middle">19</text>
      </g>
      <g id="id556">
        <text x="71.21" y="46.61" text-anchor="middle">96</text>
      </g>
      <g id="id552">
        <text x="68.62" y="40" text-anchor="middle">161</text>
      </g>
      <g id="id548">
        <text x="66.03" y="35.93" text-anchor="middle">201</text>
      </g>
      <g id="id544">
        <text x="63.44" y="41.83" text-anchor="middle">143</text>
      </g>
      <g id="id540">
        <text x="60.85" y="47.02" text-anchor="middle">92</text>
      </g>
      <g id="id536">
        <text x="58.27" y="52.61" text-anchor="middle">37</text>
      </g>
      <g id="id532">
        <text x="55.68" y="55.56" text-anchor="middle">8</text>
      </g>
      <g id="id528">
        <text x="53.09" y="55.26" text-anchor="middle">11</text>
      </g>
      <g id="id524">
        <text x="50.5" y="51.09" text-anchor="middle">52</text>
      </g>
      <g id="id520">
        <text x="47.91" y="39.29" text-anchor="middle">168</text>
      </g>
      <g id="id516">
        <text x="45.33" y="17.32" text-anchor="middle">384</text>
      </g>
      <g id="id512">
        <text x="42.74" y="9.29" text-anchor="middle">463</text>
      </g>
      <g id="id508">
        <text x="40.15" y="17.83" text-anchor="middle">379</text>
      </g>
      <g id="id504">
        <text x="37.56" y="34.21" text-anchor="middle">218</text>
      </g>
      <g id="id500">
        <text x="34.97" y="48.24" text-anchor="middle">80</text>
      </g>
      <g id="id496">
        <text x="32.39" y="54.55" text-anchor="middle">18</text>
      </g>
      <g id="id492">
        <text x="29.8" y="55.97" text-anchor="middle">4</text>
      </g>
      <g id="id488">
        <text x="27.21" y="56.38" text-anchor="middle">0</text>
      </g>
      <g id="id486">
        <text x="25.92" y="56.28" text-anchor="middle">1</text>
      </g>
      <g id="id490">
        <text x="28.51" y="56.38" text-anchor="middle">0</text>
      </g>
      <g id="id494">
        <text x="31.09" y="55.77" text-anchor="middle">6</text>
      </g>
      <g id="id498">
        <text x="33.68" y="53.22" text-anchor="middle">31</text>
      </g>
      <g id="id502">
        <text x="36.27" y="41.63" text-anchor="middle">145</text>
      </g>
      <g id="id506">
        <text x="38.86" y="22.41" text-anchor="middle">334</text>
      </g>
      <g id="id510">
        <text x="41.44" y="12.44" text-anchor="middle">432</text>
      </g>
      <g id="id514">
        <text x="44.03" y="17.02" text-anchor="middle">387</text>
      </g>
      <g id="id518">
        <text x="46.62" y="30.65" text-anchor="middle">253</text>
      </g>
      <g id="id522">
        <text x="49.21" y="45.09" text-anchor="middle">111</text>
      </g>
      <g id="id526">
        <text x="51.8" y="53.53" text-anchor="middle">28</text>
      </g>
      <g id="id530">
        <text x="54.38" y="55.46" text-anchor="middle">9</text>
      </g>
      <g id="id534">
        <text x="56.97" y="55.06" text-anchor="middle">13</text>
      </g>
      <g id="id538">
        <text x="59.56" y="51.6" text-anchor="middle">47</text>
      </g>
      <g id="id542">
        <text x="62.15" y="45.39" text-anchor="middle">108</text>
      </g>
      <g id="id546">
        <text x="64.74" y="38.58" text-anchor="middle">175</text>
      </g>
      <g id="id550">
        <text x="67.32" y="37.77" text-anchor="middle">183</text>
      </g>
      <g id="id554">
        <text x="69.91" y="45.39" text-anchor="middle">108</text>
      </g>
      <g id="id558">
        <text x="72.5" y="49.36" text-anchor="middle">69</text>
      </g>
      <g id="id562">
        <text x="75.09" y="55.06" text-anchor="middle">13</text>
      </g>
      <g id="id566">
        <text x="77.68" y="55.97" text-anchor="middle">4</text>
      </g>
    </g>
  </g>
</g>
<script type="application/ecmascript"><![CDATA[

// Functions embedded in Gadfly plots to add interactivity.


// Clicking an entry in a color key toggles visibility of the data within that
// group.
function toggle_color_group(name)
{
    geoms = document.getElementsByClassName('color_group_' + name);
    entry = document.getElementById('color_key_' + name);
    state = geoms[0].getAttribute('visibility');
    if (!state || state == 'visible') {
        for (i = 0; i < geoms.length; ++i) {
            geoms[i].setAttribute('visibility', 'hidden');
        }
        entry.setAttribute('opacity', 0.5);
    } else {
        for (i = 0; i < geoms.length; ++i) {
            geoms[i].setAttribute('visibility', 'visible');
        }
        entry.setAttribute('opacity', 1.0);
    }
}


// Turn on a possibily hidden annotation.
function show_annotation(geom_id)
{
    annot_id = geom_id + "-annotation";
    annot = document.getElementById(annot_id);
    annot.setAttribute('visibility', 'visible');
    present_geometry([geom_id]);
}


// Turn off a possibly hidden annotation.
function hide_annotation(geom_id)
{
    annot_id = geom_id + "-annotation"
    annot = document.getElementById(annot_id)
    annot.setAttribute('visibility', 'hidden')
    unpresent_geometry();
}


// Dim all geometry objects with some exceptions.
function present_geometry(ids)
{
    on_anim_dur = 0.1;

    off_anim = document.getElementById('panel-focus-filter-off-anim');
    try {
        t0 = Number(off_anim.getStartTime());
    }
    catch (err) {
        t0 = Infinity;
    }
    off_anim.endElement();

    if (t0 < Infinity) {
        t = Number(off_anim.getCurrentTime());
        d = Number(off_anim.getSimpleDuration());
        from = Number(off_anim.getAttribute('from'));
        to = Number(off_anim.getAttribute('to'));
        p = Math.max(0.0, Math.min(1.0, ((t - t0) / d)));
        v = from + p * (to - from);
    }
    else {
        p=1.0;
        v=0.0;
    }

    geoms = document.getElementsByClassName('geometry');
    for (i = 0; i < geoms.length; ++i) {
        geoms[i].setAttribute('filter', 'url(#panel-focus-filter)');
    }

    for (i = 0; i < ids.length; ++i) {
        geom = document.getElementById(ids[i]);
        geom.setAttribute('filter', 'inherit');
    }

    on_anim = document.getElementById('panel-focus-filter-on-anim');
    on_anim.setAttribute('from', v);
    on_anim.setAttribute('dur',  p * on_anim_dur + 's');
    on_anim.beginElement();
}


// Set all geometries to full opacity.
function unpresent_geometry()
{
    off_anim_dur = 0.3;

    on_anim = document.getElementById('panel-focus-filter-on-anim');
    try {
        t0 = Number(on_anim.getStartTime());
        t = Number(on_anim.getCurrentTime());
        d = Number(on_anim.getSimpleDuration());
        p = Math.max(0.0, Math.min(1.0, ((t - t0) / d)));
    }
    catch (err) {
        p = 1.0;
    }
    on_anim.endElement();

    from = Number(on_anim.getAttribute('from'));
    to = Number(on_anim.getAttribute('to'));
    v = from + p * (to - from);

    off_anim = document.getElementById('panel-focus-filter-off-anim');
    off_anim.setAttribute('from', v);
    dur = p * off_anim_dur
    off_anim.setAttribute('dur',  dur + 's');
    off_anim.addEventListener('endEvent', unpresent_geometry_end);
    off_anim.beginElement();

    // Webkit doesn't support the "onend" attribute, so we work arround.
    setTimeout("unpresent_geometry_end()", 1000 * dur);
}


// Called when the animation in unpresent_geometry finishes.
// Enabling a filter, even if it has no effect, adds an extra layer of
// rasterization, which tends to make things look like shit, so we clear all the
// filters when the animation ends.
function unpresent_geometry_end()
{
    // skip this function in the on_animation has been triggered since the last
    // off_animation.
    on_anim = document.getElementById('panel-focus-filter-on-anim');
    off_anim = document.getElementById('panel-focus-filter-off-anim');
    if (on_anim.getStartTime() > off_anim.getStartTime()) {
        return;
    }

    // Skip this if the off animation isn't actually finished.
    elapsed = off_anim.getCurrentTime() - off_anim.getStartTime()
    if (elapsed < off_anim.getSimpleDuration()) {
        return;
    }

    geoms = document.getElementsByClassName('geometry');
    for (i = 0; i < geoms.length; ++i) {
        geoms[i].setAttribute('filter', 'inherit');
    }
}


]]></script>
<defs>
    <!--A filter used to deemphasize out of focus geometries for mouseover
       -effects.-->
    <!-- TODO: flood-color needs to be set from the current theme -->
    <filter id="panel-focus-filter" x="-20%" y="-20%" width="140%" height="140%">
        <feFlood flood-color="#f5f5f5" flood-opacity="0.5" result="flood">
            <animate id="panel-focus-filter-off-anim"
                      attributeName="flood-opacity" attributeType="XML"
                      fill="freeze" begin="indefinite" dur="0.2s"
                      from="0.8" to="0.0" onend="unpresent_geometry_end"/>
            <animate id="panel-focus-filter-on-anim"
                      attributeName="flood-opacity" attributeType="XML"
                      fill="freeze" begin="indefinite" dur="0.1s"
                      from="0.0" to="0.8" onend="unpresent_geometry_end"/>
        </feFlood>
        <feComposite operator="atop" in="flood" in2="SourceGraphic" />
    </filter>
</defs>

</svg>
